<!DOCTYPE html>
<html ng-app="seagrass">
    <head>
        <meta charset="utf-8" />
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="mobile-web-app-capable" content="yes">

        <link rel="stylesheet" href="lib/onsen/css/onsenui.css">
        <link rel="stylesheet" href="lib/onsen/css/onsen-css-components.css">
        <title>SeaGrass</title>

        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="lib/onsen/js/angular/angular.js"></script>
        <script type="text/javascript" src="lib/onsen/js/onsenui.js"></script>

        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/app.js"></script>
    </head>
    <body>
        <ons-tabbar>
            <ons-tabbar-item page="metrics.html" label="Metrics" icon="tags" active="true"></ons-tabbar-item>
            <ons-tabbar-item page="control.html" label="Control" icon="gear"></ons-tabbar-item>
        </ons-tabbar>

        <script type="text/ons-template" id="metrics.html">
            <ons-page style="background-color: #f9f9f9" ng-controller="MetricsController as metrics">
                <div class="button-bar width-full" style="width: 300px; margin: 0 auto; background-color: white; margin: 8px">
                    <div class="button-bar__item" ng-class="{ active: metrics.isSelected(1)}">
                        <button class="button-bar__button" ng-click="metrics.chooseTab(1)">Members</button>
                    </div>
                    <div class="button-bar__item" ng-class="{ active: metrics.isSelected(2)}">
                        <button class="button-bar__button" ng-click="metrics.chooseTab(2)">Sensors</button>
                    </div>
                    <div class="button-bar__item" ng-class="{ active: metrics.isSelected(3)}">
                        <button class="button-bar__button" ng-click="metrics.chooseTab(3)">Main computer</button>
                    </div>
                </div>

                <div class="panel" ng-show="metrics.isSelected(1)" style="margin:8px">
                    <div ng-controller="MembersController as members">
                        <ons-list ng-show="(members.members | filter:members.batteryFilter).length > 0" style="vertical-margin: 8px">
                            <ons-list-item modifier="chevron">
                                <ons-row>
                                    <ons-col class="left">Out of battery : {{(members.members | filter:members.batteryFilter).length}}</ons-col>
                                </ons-row>
                            </ons-list-item>
                        </ons-list>

                        <div style="font-size: 12px" ng-show="members.members.length > 0">
                           <strong style="margin:8px"><ons-row><ons-col></ons-col><ons-col>Pattern</ons-col><ons-col>Battery</ons-col><ons-col>Lat</ons-col><ons-col>Lon</ons-col></ons-row></strong>
                            <div ng-repeat="member in members.members">
                                <ons-row>
                                    <ons-col><strong>{{member.name}}</strong></ons-col>
                                    <ons-col><div style="text-align: center">{{member.pattern}}</div></ons-col>
                                    <ons-col>{{member.battery | number : 1}}</ons-col>
                                    <ons-col>{{member.lat}}</ons-col>
                                    <ons-col>{{member.lon}}</ons-col>
                                </ons-row>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel" ng-show="metrics.isSelected(2)" style="margin:8px">
                    <div ng-controller="SensorsController as sensors">
                        <div style="font-size: 12px" ng-show="sensors.sensors.length > 0">
                            <strong style="margin:8px"><ons-row><ons-col></ons-col>
                                <ons-col>Threshold</ons-col>
                                <ons-col>Filter length</ons-col>
                            </ons-row></strong>
                            <div ng-repeat="sensor in sensors.sensors">
                                <ons-row>
                                    <ons-col><strong>{{sensor.name}}</strong></ons-col>
                                    <ons-col><div style="text-align: center">{{sensor.threshold}}</div></ons-col>
                                    <ons-col>{{sensor.filterLength}}</ons-col>
                                </ons-row>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel" ng-show="metrics.isSelected(3)" style="margin:8px">
                    <div ng-controller="ComputerController as computer">
                        <div style="font-size: 12px" ng-show="computer.entries.length > 0">
                            <strong style="margin:8px"><ons-row><ons-col></ons-col>
                                <ons-col>CPU</ons-col>
                                <ons-col>Battery</ons-col>
                                <ons-col>Memory</ons-col>
                            </ons-row></strong>
                            <div ng-repeat="entry in computer.entries">
                                <ons-row>
                                    <ons-col><strong>{{entry.time}}</strong></ons-col>
                                    <ons-col><div style="text-align: center">{{entry.cpu}}</div></ons-col>
                                    <ons-col>{{entry.battery}}</ons-col>
                                    <ons-col>{{entry.memory}}</ons-col>
                                </ons-row>
                            </div>
                        </div>
                    </div>
                </div>
            </ons-page>
        </script>

        <script type="text/ons-template" id="control.html">
            <ons-navigator title="Navigator" var="controlNavigator">
                    <ons-list>
                        <ons-list-item ng-controller="ControlController as control">
                            <div style="margin:8px">
                                <button class="button" ng-click="control.startup()">Statup</button>
                                <button class="button" ng-click="control.restart()">Restart</button>
                                <button class="button" ng-click="control.shutdown()">Shutdown</button>
                            </div>
                        </ons-list-item>
                        <ons-list-item modifier="chevron" ng-click="controlNavigator.pushPage('pat.html', { animation : 'slide' } )">
                            <ons-row style="margin:8px">
                                <ons-col class="left">
                                    Configure pattern
                                </ons-col>
                            </ons-row>
                        </ons-list-item>
                        <ons-list-item>

                        </ons-list-item>
                    </ons-list>
            </ons-navigator>
        </script>

        <script type="text/ons-template" id="pat.html">
            <ons-toolbar>
                <div class="left"><ons-back-button>Back</ons-back-button></div>
                <div class="center">Configure Pattern</div>
            </ons-toolbar>
            <ons-list ng-controller="PatternController">
                <ons-list-item>
                    Pattern: <select ng-model="chosen_pattern" ng-options="pattern as pattern for pattern in patterns"></select>
                </ons-list-item>
                <ons-list-item>
                    Speed: <input ng-model="speed" min="{{speedMin}}" max="{{speedMax}}" type="range" class="range">
                </ons-list-item>
                <ons-list-item>
                    Intensity: <input ng-model="intensity" min="{{intensityMin}}" max="{{intensityMax}}" type="range" class="range">
                </ons-list-item>
                <ons-list-item>
                    Red: <input ng-model="red" min="0" max="255" type="range" class="range" style="width:270px">
                </ons-list-item>
                <ons-list-item>
                    Green: <input ng-model="green" min="0" max="255" type="range" class="range" style="width:270px">
                </ons-list-item>
                <ons-list-item>
                    Blue: <input ng-model="blue" min="0" max="255" type="range" class="range" style="width:270px">
                </ons-list-item>
            </ons-list>
        </script>
   </body>
</html>
